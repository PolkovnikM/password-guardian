name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  check-structure:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Display structure
      run: |
        echo " Структура проекта:"
        find . -type f -name "*.py" -o -name "*.html" -o -name "*.css" -o -name "*.js" | sort
        echo ""
        echo "✅ Проверка структуры завершена"
    
    - name: Check Python files
      run: |
        if [ -f "backend/app/main.py" ]; then
          echo "✅ main.py найден"
        else
          echo "❌ main.py не найден"
          exit 1
        fi
        
        if [ -f "backend/app/generator.py" ]; then
          echo "✅ generator.py найден"
        else
          echo "❌ generator.py не найден"
          exit 1
        fi
        
        if [ -f "backend/app/validator.py" ]; then
          echo "✅ validator.py найден"
        else
          echo "❌ validator.py не найден"
          exit 1
        fi

  simple-test:
    runs-on: ubuntu-latest
    needs: check-structure
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Display success
      run: |
        echo " Все проверки пройдены!"
        echo "Проект Password Guardian готов к работе."
        echo ""
        echo " Статистика:"
        echo "- Python файлов: $(find . -name "*.py" | wc -l)"
        echo "- HTML файлов: $(find . -name "*.html" | wc -l)"
        echo "- Всего файлов: $(find . -type f | wc -l)"
